# הוראות הגדרת טלגרם

## 1. הגדרת משתנה סביבה

### מקומי (.env.local)
צור או עדכן את הקובץ `.env.local` והוסף:

```env
TELEGRAM_BOT_TOKEN=8315054897:AAHH-twOiv2Ud1iSZ9_S08KsScWEuspFKRo
```

### ב-Vercel
1. עבור ל-Vercel Dashboard > הפרויקט שלך
2. לחץ על Settings > Environment Variables
3. הוסף משתנה חדש:
   - **Name**: `TELEGRAM_BOT_TOKEN`
   - **Value**: `8315054897:AAHH-twOiv2Ud1iSZ9_S08KsScWEuspFKRo`
   - **Environment**: Production, Preview, Development (בחר את כולם)
4. לחץ "Save"
5. **חשוב**: פרס מחדש את האפליקציה כדי שהמשתנה יטען

## 2. הגדרת Chat ID

### דרך 1: דרך דשבורד האדמין (מומלץ)
1. התחבר כאדמין
2. עבור לדשבורד האדמין (`/admin`)
3. בסקשן "הגדרות התראות טלגרם":
   - לחץ על הקישור "פתח בטלגרם"
   - שלח `/start` לבוט
   - הבוט ישלח לך את ה-Chat ID
   - העתק את ה-Chat ID ושמור אותו בשדה "Chat ID"

### דרך 2: ידנית
1. פתח צ'אט עם הבוט בטלגרם
2. שלח הודעה כלשהי לבוט
3. פתח בדפדפן: `https://api.telegram.org/bot8315054897:AAHH-twOiv2Ud1iSZ9_S08KsScWEuspFKRo/getUpdates`
4. חפש את ה-`chat.id` בהודעה האחרונה
5. העתק את המספר ושמור אותו ב-Firestore ב-`adminSettings/telegram` בשדה `chatId`

## 3. בדיקת החיבור

1. בדשבורד האדמין, לחץ על "📤 שלח הודעת בדיקה"
2. אם הכל תקין, תקבל הודעה בטלגרם: "✅ בדיקת חיבור - הכל תקין!"
3. אם יש שגיאה, תראה הודעת שגיאה בממשק

## 4. סוגי התראות

המערכת שולחת התראות אוטומטיות על:

1. **רישום משתמש חדש** - כשמשתמש נרשם (Email או Google)
2. **שגיאות למשתמש** - שגיאות קריטיות שמשפיעות על משתמש ספציפי
3. **שגיאות כלליות** - שגיאות במערכת שלא קשורות למשתמש ספציפי

## פתרון בעיות

### הטוקן לא נטען
- ודא שהוספת את `TELEGRAM_BOT_TOKEN` למשתני סביבה
- ב-Vercel: ודא שפרסת מחדש אחרי הוספת המשתנה
- מקומי: ודא שהקובץ `.env.local` קיים וש-`TELEGRAM_BOT_TOKEN` מוגדר

### Chat ID לא נשמר
- ודא שיש לך הרשאות אדמין
- בדוק את הקונסולה לשגיאות
- נסה לשמור שוב

### הודעות לא נשלחות
- לחץ על "בדוק חיבור" כדי לראות מה הבעיה
- ודא שה-Chat ID נכון
- ודא שהבוט פעיל ולא נחסם
